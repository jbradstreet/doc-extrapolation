{"version":3,"sources":["components/auth/router.decorator.js"],"names":[],"mappings":"AAAA;;AAEA,CAAC,YAAW;;AAEV,UAAQ,MAAR,CAAe,0BAAf,EACG,GADH,CACO,UAAS,UAAT,EAAqB,SAArB,EAAgC,IAAhC,EAAsC;;AAEzC,eAAW,GAAX,CAAe,mBAAf,EAAoC,UAAS,KAAT,EAAgB,IAAhB,EAAsB;AACxD,UAAI,CAAC,KAAK,YAAV,EAAwB;AACtB;AACD;;AAED,UAAI,OAAO,KAAK,YAAZ,KAA6B,QAAjC,EAA2C;AACzC,aAAK,OAAL,CAAa,KAAK,YAAlB,EAAgC,EAAE,IAAlC,EACG,IADH,CACQ,eAAO;AACX,cAAI,GAAJ,EAAS;AACP;AACD;;AAED,gBAAM,cAAN;AACA,iBAAO,KAAK,UAAL,CAAgB,EAAE,IAAlB,EACJ,IADI,CACC,cAAM;AACV,sBAAU,IAAV,CAAe,KAAK,GAAL,GAAW,QAA1B;AACD,WAHI,CAAP;AAID,SAXH;AAYD,OAbD,MAaO;AACL,aAAK,UAAL,CAAgB,EAAE,IAAlB,EACG,IADH,CACQ,cAAM;AACV,cAAI,EAAJ,EAAQ;AACN;AACD;;AAED,gBAAM,cAAN;AACA,oBAAU,IAAV,CAAe,GAAf;AACD,SARH;AASD;AACF,KA7BD;AA8BD,GAjCH;AAkCD,CApCD","file":"components/auth/router.decorator.js","sourcesContent":["'use strict';\n\n(function() {\n\n  angular.module('docExtrapolationApp.auth')\n    .run(function($rootScope, $location, Auth) {\n      // Redirect to login if route requires auth and the user is not logged in, or doesn't have required role\n      $rootScope.$on('$routeChangeStart', function(event, next) {\n        if (!next.authenticate) {\n          return;\n        }\n\n        if (typeof next.authenticate === 'string') {\n          Auth.hasRole(next.authenticate, _.noop)\n            .then(has => {\n              if (has) {\n                return;\n              }\n\n              event.preventDefault();\n              return Auth.isLoggedIn(_.noop)\n                .then(is => {\n                  $location.path(is ? '/' : '/login');\n                });\n            });\n        } else {\n          Auth.isLoggedIn(_.noop)\n            .then(is => {\n              if (is) {\n                return;\n              }\n\n              event.preventDefault();\n              $location.path('/');\n            });\n        }\n      });\n    });\n})();\n"],"sourceRoot":"/source/"}